<!--
Checks the format of data received from the parent element to determine which
disaggregation-table component to display.
 -->

<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../behaviors/utils.html">
<link rel="import" href="../../styles/detail-table.html">
<link rel="import" href="table-content/three-disaggregations.html">
<link rel="import" href="table-content/two-disaggregations.html">
<link rel="import" href="table-content/one-disaggregation.html">
<link rel="import" href="table-content/zero-disaggregations.html">

<dom-module id="disaggregation-table">
  <template>

    <style include="detail-table">
      :host(.fullWidth) table {
        width:100%;
      }
    </style>

    <table class='vertical layout'>

      <!-- Note: Need to pass in mapping to these or an empty mapping is passed
      to the content component. -->

      <template is="dom-if" if="[[_isSameNumberOfDisaggregations(data, 0)]]">
        <zero-disaggregations
          data="[[data]]"
          total="[[total]]"
          mapping="[[mapping]]">
        </zero-disaggregations>
      </template>

      <template is="dom-if" if="[[_isSameNumberOfDisaggregations(data, 1, mapping)]]">
        <one-disaggregation
          data="[[data]]"
          total="[[total]]"
          mapping="[[mapping]]"
          editable="[[editable]]">
        </one-disaggregation>
      </template>

      <template is="dom-if" if="[[_isSameNumberOfDisaggregations(data, 2, mapping)]]">
        <two-disaggregations
          data="[[data]]"
          total="[[total]]"
          mapping="[[mapping]]"
          editable="[[editable]]">
        </two-disaggregations>
      </template>

      <template is="dom-if" if="[[_isSameNumberOfDisaggregations(data, 3, mapping)]]">
        <three-disaggregations
          data="[[data]]"
          total="[[total]]"
          mapping="[[mapping]]"
          editable="[[editable]]">
        </three-disaggregations>
      </template>

    </table>

  </template>

  <script>

    Polymer({
      is: 'disaggregation-table',

      behaviors: [
        App.Behaviors.UtilsBehavior,
      ],

      properties: {
        data: {
          type: Object,
          value: {}
        },
        mapping: {
          type: Object,
          value: {}
        },
        total: Number,
        editable: Boolean
      },

      _isSameNumberOfDisaggregations(data, num) {
        if (num === data.num_disaggregation) {
          return true;
        }
        return false;
      },
    });
  </script>
</dom-module>
